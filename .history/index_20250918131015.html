<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ChorePlay: Pixel Tic-Tac-Toe (Blue/Yellow)</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#e0f2ff; --card:#ffffff; --accent:#ffd60a; --accent-2:#3b82f6; --muted:#6b7280; --pixel:#0f1724; --tile:#dbeafe;
}
*{box-sizing:border-box}
html,body{height:100%;}
body{margin:0; font-family: 'Press Start 2P', system-ui, -apple-system, 'Segoe UI', Roboto, Arial; background:linear-gradient(180deg,#cfe8ff 0%, #ffffff 60%); color:var(--pixel); display:flex; align-items:center; justify-content:center; padding:28px;}
.wrap{width:min(920px,96vw); display:grid; grid-template-columns:360px 1fr; gap:20px; align-items:start}
.card{background:var(--card); border:6px solid var(--pixel); border-radius:8px; padding:18px; box-shadow:12px 12px 0 rgba(0,0,0,0.06);}
header{display:flex; gap:12px; align-items:center}
.logo{width:64px; height:64px; background:var(--accent-2); border:6px solid var(--pixel); display:grid; place-items:center; border-radius:6px; animation: bounce 1s infinite alternate;}
@keyframes bounce {0%{transform:translateY(0)}100%{transform:translateY(-6px)}}
h1{margin:0; font-size:14px; line-height:1.05}
.subtitle{font-size:9px; color:var(--muted); margin-top:6px}
.board-wrap{display:flex; flex-direction:column; gap:12px; margin-top:12px}
.board{display:grid; grid-template-columns:repeat(3,1fr); gap:10px; background:repeating-linear-gradient(45deg,#fff 0 10px,#fff6 10px 20px); padding:10px; border:6px solid var(--pixel); border-radius:6px}
.cell{aspect-ratio:1 / 1; display:flex; align-items:center; justify-content:center; font-size:36px; cursor:pointer; background:var(--tile); border:4px solid var(--pixel); border-radius:4px; box-shadow:4px 4px 0 rgba(0,0,0,0.06); user-select:none; position:relative;}
.cell.x::after, .cell.o::after{content:''; position:absolute; width:100%; height:100%; background-repeat:no-repeat; background-size:contain; animation:flip 0.6s ease forwards;}
.cell.x::after{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAUElEQVQokWNgQAL+DwX+nwI3YGBg8cL/B8R/0MyMDQA+I8CFIDkJYGnQCUjsBOoSEVlg0STAJpCwGgRiPkA4gFjJpANiwkOoAbkzFBHqIbID0AQCh1H9i1zqI5wAAAABJRU5ErkJggg==');}
.cell.o::after{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAQUlEQVQokWNgQAP/DwX8nwI0YGBg2QIE/dP/F0AAsxqk0BAwDAiA+4gMKkgdOQHZgOqAG2IDwA3QIkqHCLF4lDAAAlPoLK89exuAAAAABJRU5ErkJggg==');}
@keyframes flip {0%{transform:rotateY(90deg); opacity:0}100%{transform:rotateY(0deg); opacity:1}}
.cell.win{background:linear-gradient(180deg,#fff7c2,#ffd79a)}
.controls{display:flex; gap:10px; align-items:center; margin-top:12px}
.btn{padding:10px 12px; border:6px solid var(--pixel); background:var(--accent); color:white; font-size:11px; border-radius:6px; cursor:pointer}
.btn.secondary{background:var(--accent-2)}
.chore-card{background:#fffbe6; border:6px solid var(--pixel); padding:12px; border-radius:6px; margin-top:12px}
.chore-title{font-size:11px; margin:0 0 6px 0}
.chore-prompt{font-size:10px; color:var(--pixel); margin-bottom:8px}
.chore-btn{display:inline-block; padding:10px 14px; font-size:12px; border:6px solid var(--pixel); background:var(--accent); border-radius:6px; cursor:pointer; animation: pulse 1s infinite alternate;}
@keyframes pulse {0%{transform:scale(1)}100%{transform:scale(1.05)}}
.meta-card{background:linear-gradient(180deg,#e0f2ff,#ffffff); border:6px solid var(--pixel); padding:16px; border-radius:8px}
.meta-card h2{margin:0 0 8px 0; font-size:12px}
.small{font-size:10px; color:var(--muted)}
.footer{grid-column:1/-1; text-align:center; margin-top:10px; font-size:9px; color:var(--muted)}
/* Venmo modal */
.modal-backdrop{position:fixed; inset:0; background:rgba(2,6,23,0.6); display:grid; place-items:center; z-index:60}
.modal{width:min(420px,94vw); background:linear-gradient(180deg,#fff,#f0f8ff); border:6px solid var(--pixel); padding:18px; border-radius:8px; box-shadow:16px 16px 0 rgba(0,0,0,0.06);}
.modal h3{margin:0 0 10px 0; font-size:12px}
.input{width:100%; padding:10px; border:6px solid var(--pixel); border-radius:6px; font-family:inherit; font-size:12px}
.row{display:flex; gap:8px; margin-top:10px}
.notice{font-size:10px; color:var(--muted); margin-top:8px}
.badge{display:inline-block; padding:6px 8px; background:var(--accent-2); color:white; border-radius:6px; font-size:10px}
@media (max-width:820px){.wrap{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <header>
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>ChorePlay
          <div class="subtitle">Pixel Ticâ€‘Tacâ€‘Toe for kids</div>
        </h1>
      </div>
    </header>

    <div class="board-wrap">
      <div id="status" class="small">Complete a chore to unlock your move!</div>

      <div class="board" id="board" role="grid" aria-label="Tic tac toe board"></div>

      <div class="controls">
        <button id="resetBtn" class="btn">New Round</button>
        <button id="resetAllBtn" class="btn secondary">Reset Scores</button>
        <div style="flex:1"></div>
        <div class="small">Press <strong>R</strong> for new round</div>
      </div>
    </div>

    <div class="footer">Designed to encourage small chores â€” game time after work is done! ðŸ’™ðŸ’›</div>
  </div>

  <div class="meta-card">
    <h2>Chore Station</h2>
    <div class="chore-card">
      <div class="chore-title">Today's chore</div>
      <div id="chorePrompt" class="chore-prompt">Fold the laundry</div>
      <button id="choreBtn" class="chore-btn" aria-pressed="false" disabled>Locked â€” make a mock Venmo to unlock</button>
    </div>

    <hr style="margin:12px 0" />

    <div>
      <div class="small">Game mode</div>
      <div style="display:flex; gap:8px; margin-top:8px">
        <button id="toggleAiBtn" class="btn secondary">Play vs: Two players</button>
        <button id="editChoreBtn" class="btn">Edit Chore</button>
      </div>
    </div>

    <div style="margin-top:12px">
      <div class="small">Scores</div>
      <div style="display:flex; gap:8px; margin-top:8px">
        <div class="small">X: <span id="scoreX">0</span></div>
        <div class="small">O: <span id="scoreO">0</span></div>
        <div class="small">T: <span id="scoreT">0</span></div>
      </div>
    </div>

    <div style="margin-top:12px">
      <div class="small">Chore list</div>
      <ul id="choreList" class="small" style="margin:8px 0 0 16px; padding:0"></ul>
      <div style="margin-top:8px; display:flex; gap:6px">
        <input id="newChoreInput" placeholder="Add custom chore" style="flex:1; padding:8px; border:6px solid var(--pixel); border-radius:6px; font-family:inherit; font-size:11px" />
        <button id="addChoreBtn" class="btn">Add</button>
      </div>
    </div>
  </div>
</div>

<!-- Mock Venmo Modal (requires input before the game unlocks) -->
<div id="venmoModal" class="modal-backdrop" role="dialog" aria-modal="true" aria-label="Mock Venmo payment">
  <div class="modal">
    <h3>Mock Venmo â€” Just for Fun</h3>
    <div class="small">Type a Venmo username and press <strong>Pay</strong>. This is a playful, fake step â€” no real money is used.</div>
    <input id="venmoInput" class="input" placeholder="@yourvenmohandle" aria-label="Venmo username" />
    <div class="row">
      <button id="venmoPayBtn" class="btn">Pay (mock)</button>
      <button id="venmoSkipBtn" class="btn secondary">Skip (demo)</button>
    </div>
    <div class="notice">This demo stores your mock payment username locally so the game remembers the gate for this browser.</div>
  </div>
</div>

<script>
// --- Game logic (same as before) ---
const WIN_COMBOS=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
const boardEl=document.getElementById('board');
const statusEl=document.getElementById('status');
const chorePromptEl=document.getElementById('chorePrompt');
const choreBtn=document.getElementById('choreBtn');
const toggleAiBtn=document.getElementById('toggleAiBtn');
const editChoreBtn=document.getElementById('editChoreBtn');
const newChoreInput=document.getElementById('newChoreInput');
const addChoreBtn=document.getElementById('addChoreBtn');
const choreListEl=document.getElementById('choreList');
const resetBtn=document.getElementById('resetBtn');
const resetAllBtn=document.getElementById('resetAllBtn');
const scoreXEl=document.getElementById('scoreX');
const scoreOEl=document.getElementById('scoreO');
const scoreTEl=document.getElementById('scoreT');
let board=Array(9).fill(null);let cells=[];let current='X';let running=true;let canPlay=false;let vsAI=false;let scores={X:0,O:0,T:0};
let chores=['Fold the laundry','Put toys away','Wipe the table','Water the plants','Take out the trash','Sweep the floor'];

function init(){boardEl.innerHTML='';cells=[];for(let i=0;i<9;i++){const cell=document.createElement('button');cell.className='cell';cell.dataset.index=i;cell.setAttribute('aria-label','Cell '+(i+1));cell.addEventListener('click',onCellClick);boardEl.appendChild(cell);cells.push(cell);}updateScores();startNewRound();populateChoreList();checkVenmoGate();}
function updateScores(){scoreXEl.textContent=scores.X;scoreOEl.textContent=scores.O;scoreTEl.textContent=scores.T;}
function onCellClick(e){const i=Number(e.currentTarget.dataset.index);if(!running||board[i]||!canPlay)return;makeMove(i,current);canPlay=false;generateChore();}
function makeMove(i,player){board[i]=player;cells[i].textContent=player;cells[i].classList.add(player.toLowerCase());const win=checkWin(player);if(win){running=false;win.forEach(idx=> cells[idx].classList.add('win'));updateStatus(`Player ${player} wins!`);scores[player]++;updateScores();return;}if(board.every(Boolean)){running=false;updateStatus(`It's a tie.`);scores.T++;updateScores();return;}current=player==='X'?'O':'X';updateStatus(`Player ${current}'s turn â€” complete the chore!`);}function checkWin(player){for(const combo of WIN_COMBOS){if(combo.every(idx=>board[idx]===player))return combo;}return null;}function updateStatus(txt){statusEl.textContent=txt;}

function generateChore(){const c=chores[Math.floor(Math.random()*chores.length)];chorePromptEl.textContent=c;choreBtn.setAttribute('aria-pressed','false');}

choreBtn.addEventListener('click',()=>{if(choreBtn.disabled) return;choreBtn.setAttribute('aria-pressed','true');canPlay=true;updateStatus(`Player ${current}'s turn â€” tap a cell!`);});
addChoreBtn.addEventListener('click',()=>{const t=newChoreInput.value.trim();if(!t) return;chores.push(t);newChoreInput.value='';populateChoreList();});
function populateChoreList(){choreListEl.innerHTML='';chores.forEach((c,idx)=>{const li=document.createElement('li');li.textContent=c;li.style.marginBottom='6px';const del=document.createElement('button');del.textContent='âœ•';del.style.marginLeft='8px';del.style.border='none';del.style.background='transparent';del.style.cursor='pointer';del.addEventListener('click',()=>{chores.splice(idx,1);populateChoreList();});li.appendChild(del);choreListEl.appendChild(li);});}

toggleAiBtn.addEventListener('click',()=>{vsAI=!vsAI;toggleAiBtn.textContent=vsAI?'Play vs: AI (O)':'Play vs: Two players';startNewRound();});
editChoreBtn.addEventListener('click',()=>{const custom=prompt('Enter a chore to use for the next turn:',chores[0]||'Fold the laundry');if(custom){chores.unshift(custom);populateChoreList();generateChore();}});
function computeAIMove(){for(let i=0;i<9;i++){if(!board[i]){board[i]='O';if(checkWin('O')){board[i]=null;return i;}board[i]=null;}}for(let i=0;i<9;i++){if(!board[i]){board[i]='X';if(checkWin('X')){board[i]=null;return i;}board[i]=null;}}if(!board[4])return 4;const corners=[0,2,6,8].filter(i=>!board[i]);if(corners.length) return corners[Math.floor(Math.random()*corners.length)];const sides=[1,3,5,7].filter(i=>!board[i]);if(sides.length) return sides[Math.floor(Math.random()*sides.length)];return null;}

function startNewRound(){board=Array(9).fill(null);running=true;canPlay=false;current='X';cells.forEach(c=>{c.textContent='';c.className='cell';c.disabled=false;});generateChore();updateStatus(`Player ${current}'s turn â€” complete the chore!`);}resetBtn.addEventListener('click',startNewRound);resetAllBtn.addEventListener('click',()=>{scores={X:0,O:0,T:0};updateScores();startNewRound();});window.addEventListener('keydown',(e)=>{if(e.key.toLowerCase()==='r') startNewRound();if(e.key==='Escape'){startNewRound();}});

// --- Mock Venmo gate logic ---
const venmoModal=document.getElementById('venmoModal');
const venmoInput=document.getElementById('venmoInput');
const venmoPayBtn=document.getElementById('venmoPayBtn');
const venmoSkipBtn=document.getElementById('venmoSkipBtn');

function checkVenmoGate(){
  const paid = localStorage.getItem('choreplay_paid');
  if(paid){ unlockGame(paid); } else { showVenmoModal(); }
}

function showVenmoModal(){ venmoModal.style.display='grid'; venmoInput.value=''; venmoInput.focus(); choreBtn.disabled=true; }
function hideVenmoModal(){ venmoModal.style.display='none'; }

venmoPayBtn.addEventListener('click', ()=>{
  const val = venmoInput.value.trim();
  if(!val || !/^@?\w{2,}$/i.test(val)){
    alert('Please enter a mock Venmo username (like @sam).');
    venmoInput.focus();
    return;
  }
  const handle = val.startsWith('@')? val : '@'+val;
  // store mock payment record locally
  localStorage.setItem('choreplay_paid', handle);
  unlockGame(handle);
  hideVenmoModal();
});

venmoSkipBtn.addEventListener('click', ()=>{
  // demo skip: still records a demo handle but marks as demo
  localStorage.setItem('choreplay_paid', '@demo');
  unlockGame('@demo');
  hideVenmoModal();
});

function unlockGame(handle){
  // enable chore button and show a badge
  choreBtn.disabled = false;
  choreBtn.textContent = 'I did it!';
  const badge = document.createElement('div'); badge.className='badge'; badge.textContent = 'Paid: '+handle; badge.style.marginTop='10px';
  // attach badge to meta-card if not present
  const meta = document.querySelector('.meta-card'); if(meta && !meta.querySelector('.badge')) meta.insertBefore(badge, meta.firstChild.nextSibling);
  generateChore();
}

// allow clearing mock payment for testing
function clearMockPayment(){ localStorage.removeItem('choreplay_paid'); showVenmoModal(); }

// init app
init();
</script>
</body>
</html>
