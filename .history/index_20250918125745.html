<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChorePlay: Pixel Tic‑Tac‑Toe</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f0f9ff; --card:#fff; --accent:#ff7ab6; --accent-2:#60a5fa; --muted:#6b7280; --pixel:#0f1724; --tile:#ffd6e8;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0; font-family: 'Press Start 2P', system-ui, -apple-system, 'Segoe UI', Roboto, Arial; background:linear-gradient(180deg,#e6f7ff 0%, #fff 60%); color:var(--pixel); display:flex; align-items:center; justify-content:center; padding:28px;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }

    /* container */
    .wrap{width:min(920px,96vw); display:grid; grid-template-columns:360px 1fr; gap:20px; align-items:start}
    .card{
      background:var(--card); border:6px solid var(--pixel); border-radius:8px; padding:18px; box-shadow:12px 12px 0 rgba(0,0,0,0.06);
    }

    /* header */
    header{display:flex; gap:12px; align-items:center}
    .logo{width:64px; height:64px; background:linear-gradient(180deg,var(--accent),var(--accent-2)); border:6px solid var(--pixel); display:grid; place-items:center; border-radius:6px}
    .logo svg{width:46px; height:46px; image-rendering:pixelated}
    h1{margin:0; font-size:14px; line-height:1.05}
    .subtitle{font-size:9px; color:var(--muted); margin-top:6px}

    /* board area */
    .board-wrap{display:flex; flex-direction:column; gap:12px}
    .board{display:grid; grid-template-columns:repeat(3,1fr); gap:10px; background:repeating-linear-gradient(45deg,#fff 0 10px,#fff6 10px 20px); padding:10px; border:6px solid var(--pixel); border-radius:6px}
    .cell{aspect-ratio:1 / 1; display:flex; align-items:center; justify-content:center; font-size:36px; cursor:pointer; background:var(--tile); border:4px solid var(--pixel); border-radius:4px; box-shadow:4px 4px 0 rgba(0,0,0,0.06); user-select:none}
    .cell.x{color:#d94664}
    .cell.o{color:#0ea5a4}
    .cell.win{background:linear-gradient(180deg,#fff7c2,#ffd79a)}

    /* controls */
    .controls{display:flex; gap:10px; align-items:center}
    .btn{padding:10px 12px; border:6px solid var(--pixel); background:var(--accent); color:white; font-size:11px; border-radius:6px; cursor:pointer}
    .btn.secondary{background:var(--accent-2)}

    /* chore box */
    .chore-card{background:#fffbe6; border:6px solid var(--pixel); padding:12px; border-radius:6px}
    .chore-title{font-size:11px; margin:0 0 6px 0}
    .chore-prompt{font-size:10px; color:var(--pixel); margin-bottom:8px}
    .chore-btn{display:inline-block; padding:10px 14px; font-size:12px; border:6px solid var(--pixel); background:#ffe0f0; border-radius:6px; cursor:pointer}

    /* right panel */
    .meta-card{background:linear-gradient(180deg,#fff,#f8fbff); border:6px solid var(--pixel); padding:16px; border-radius:8px}
    .meta-card h2{margin:0 0 8px 0; font-size:12px}
    .small{font-size:10px; color:var(--muted)}

    /* footer */
    .footer{grid-column:1/-1; text-align:center; margin-top:10px; font-size:9px; color:var(--muted)}

    /* responsive */
    @media (max-width:820px){.wrap{grid-template-columns:1fr;}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <div class="logo" aria-hidden="true">
          <!-- cute pixel heart + star svg -->
          <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges">
            <rect x="1" y="12" width="6" height="6" fill="#fff"/>
            <rect x="8" y="8" width="8" height="8" fill="#fff"/>
            <rect x="18" y="4" width="8" height="8" fill="#fff"/>
            <rect x="6" y="18" width="20" height="8" fill="#fff"/>
          </svg>
        </div>
        <div>
          <h1>ChorePlay
            <div class="subtitle">Pixel Tic‑Tac‑Toe for kids</div>
          </h1>
        </div>
      </header>

      <div class="board-wrap" style="margin-top:12px">
        <div id="status" class="small">Complete a chore to unlock your move!</div>
        <div class="board card" id="board" role="grid" aria-label="Tic tac toe board">
          <!-- cells generated by script -->
        </div>

        <div class="controls">
          <button id="resetBtn" class="btn">New Round</button>
          <button id="resetAllBtn" class="btn secondary">Reset Scores</button>
          <div style="flex:1"></div>
          <div class="small">Press <strong>R</strong> for new round</div>
        </div>
      </div>

      <div class="footer">Designed to encourage small chores — game time after work is done! ❤️</div>
    </div>

    <div class="meta-card">
      <h2>Chore Station</h2>
      <div class="chore-card">
        <div class="chore-title">Today's chore</div>
        <div id="chorePrompt" class="chore-prompt">Fold the laundry</div>
        <button id="choreBtn" class="chore-btn" aria-pressed="false">I did it!</button>
      </div>

      <hr style="margin:12px 0" />

      <div>
        <div class="small">Game mode</div>
        <div style="display:flex; gap:8px; margin-top:8px">
          <button id="toggleAiBtn" class="btn secondary">Play vs: Two players</button>
          <button id="editChoreBtn" class="btn">Edit Chore</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="small">Scores</div>
        <div style="display:flex; gap:8px; margin-top:8px">
          <div class="small">X: <span id="scoreX">0</span></div>
          <div class="small">O: <span id="scoreO">0</span></div>
          <div class="small">T: <span id="scoreT">0</span></div>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="small">Chore list</div>
        <ul id="choreList" class="small" style="margin:8px 0 0 16px; padding:0">
        </ul>
        <div style="margin-top:8px; display:flex; gap:6px">
          <input id="newChoreInput" placeholder="Add custom chore" style="flex:1; padding:8px; border:6px solid var(--pixel); border-radius:6px; font-family:inherit; font-size:11px" />
          <button id="addChoreBtn" class="btn">Add</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Game constants
    const WIN_COMBOS = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

    // Elements
    const boardEl = document.getElementById('board');
    const statusEl = document.getElementById('status');
    const chorePromptEl = document.getElementById('chorePrompt');
    const choreBtn = document.getElementById('choreBtn');
    const toggleAiBtn = document.getElementById('toggleAiBtn');
    const editChoreBtn = document.getElementById('editChoreBtn');
    const newChoreInput = document.getElementById('newChoreInput');
    const addChoreBtn = document.getElementById('addChoreBtn');
    const choreListEl = document.getElementById('choreList');

    const resetBtn = document.getElementById('resetBtn');
    const resetAllBtn = document.getElementById('resetAllBtn');

    const scoreXEl = document.getElementById('scoreX');
    const scoreOEl = document.getElementById('scoreO');
    const scoreTEl = document.getElementById('scoreT');

    // State
    let board = Array(9).fill(null);
    let cells = [];
    let current = 'X';
    let running = true;
    let canPlay = false;
    let vsAI = false;
    let scores = {X:0,O:0,T:0};

    // chores
    let chores = ['Fold the laundry','Put toys away','Wipe the table','Water the plants','Take out the trash','Sweep the floor'];

    // init
    function init(){
      boardEl.innerHTML = '';
      cells = [];
      for(let i=0;i<9;i++){
        const cell = document.createElement('button');
        cell.className = 'cell';
        cell.dataset.index = i;
        cell.setAttribute('aria-label', 'Cell '+(i+1));
        cell.addEventListener('click', onCellClick);
        boardEl.appendChild(cell);
        cells.push(cell);
      }
      updateScores();
      startNewRound();
      populateChoreList();
    }

    function updateScores(){ scoreXEl.textContent = scores.X; scoreOEl.textContent = scores.O; scoreTEl.textContent = scores.T; }

    function onCellClick(e){
      const i = Number(e.currentTarget.dataset.index);
      if(!running || board[i] || !canPlay) return;
      makeMove(i, current);
      canPlay = false;
      // after move, if AI and still running, AI will take turn only after chore completed for fairness
      generateChore();
    }

    function makeMove(i, player){
      board[i] = player;
      cells[i].textContent = player;
      cells[i].classList.add(player.toLowerCase());
      const win = checkWin(player);
      if(win){
        running = false;
        win.forEach(idx=> cells[idx].classList.add('win'));
        updateStatus(`Player ${player} wins!`);
        scores[player]++;
        updateScores();
        return;
      }
      if(board.every(Boolean)){
        running = false;
        updateStatus(`It's a tie.`);
        scores.T++;
        updateScores();
        return;
      }
      current = player === 'X' ? 'O' : 'X';
      updateStatus(`Player ${current}'s turn — complete the chore!`);
    }

    function checkWin(player){
      for(const combo of WIN_COMBOS){
        if(combo.every(idx => board[idx] === player)) return combo;
      }
      return null;
    }

    function updateStatus(txt){ statusEl.textContent = txt; }

    // chores
    function generateChore(){
      const c = chores[Math.floor(Math.random()*chores.length)];
      chorePromptEl.textContent = c;
      choreBtn.setAttribute('aria-pressed','false');
    }

    choreBtn.addEventListener('click', ()=>{
      // mark done and allow play
      choreBtn.setAttribute('aria-pressed','true');
      canPlay = true;
      updateStatus(`Player ${current}'s turn — tap a cell!`);
    });

    // chore management
    addChoreBtn.addEventListener('click', ()=>{
      const t = newChoreInput.value.trim();
      if(!t) return;
      chores.push(t);
      newChoreInput.value = '';
      populateChoreList();
    });

    function populateChoreList(){
      choreListEl.innerHTML = '';
      chores.forEach((c,idx)=>{
        const li = document.createElement('li');
        li.textContent = c;
        li.style.marginBottom = '6px';
        const del = document.createElement('button');
        del.textContent = '✕';
        del.style.marginLeft = '8px';
        del.style.border = 'none';
        del.style.background = 'transparent';
        del.style.cursor = 'pointer';
        del.addEventListener('click', ()=>{ chores.splice(idx,1); populateChoreList(); });
        li.appendChild(del);
        choreListEl.appendChild(li);
      });
    }

    // toggles
    toggleAiBtn.addEventListener('click', ()=>{
      vsAI = !vsAI;
      toggleAiBtn.textContent = vsAI ? 'Play vs: AI (O)' : 'Play vs: Two players';
      startNewRound();
    });

    editChoreBtn.addEventListener('click', ()=>{
      const custom = prompt('Enter a chore to use for the next turn:', chores[0] || 'Fold the laundry');
      if(custom) { chores.unshift(custom); populateChoreList(); generateChore(); }
    });

    // AI: simple but fair (does not auto-play; AI also must "do a chore" by clicking the chore button)
    function computeAIMove(){
      // try win
      for(let i=0;i<9;i++){
        if(!board[i]){ board[i] = 'O'; if(checkWin('O')){ board[i]=null; return i; } board[i]=null; }
      }
      // block
      for(let i=0;i<9;i++){
        if(!board[i]){ board[i] = 'X'; if(checkWin('X')){ board[i]=null; return i; } board[i]=null; }
      }
      if(!board[4]) return 4;
      const corners=[0,2,6,8].filter(i=>!board[i]); if(corners.length) return corners[Math.floor(Math.random()*corners.length)];
      const sides=[1,3,5,7].filter(i=>!board[i]); if(sides.length) return sides[Math.floor(Math.random()*sides.length)];
      return null;
    }

    // new round
    function startNewRound(){
      board = Array(9).fill(null);
      running = true;
      canPlay = false;
      current = 'X';
      cells.forEach(c=>{ c.textContent=''; c.className='cell'; c.disabled = false; });
      generateChore();
      updateStatus(`Player ${current}'s turn — complete the chore!`);
    }

    resetBtn.addEventListener('click', startNewRound);
    resetAllBtn.addEventListener('click', ()=>{ scores={X:0,O:0,T:0}; updateScores(); startNewRound(); });

    // keyboard
    window.addEventListener('keydown', (e)=>{ if(e.key.toLowerCase()==='r') startNewRound(); if(e.key==='Escape') { startNewRound(); } });

    // initial setup
    init();
  </script>
</body>
</html>
